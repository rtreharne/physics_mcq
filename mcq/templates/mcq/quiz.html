{% extends 'mcq/base.html' %}
{% load custom_tags %}
{% load static %}

{% block title %}Quiz - Physics MCQs{% endblock %}

{% block content %}

{% csrf_token %}
<meta name="csrf-token" content="{{ csrf_token }}">

<!-- Progress Display -->
<div class="mb-3">
  <strong id="quiz-progress">Question 1 of {{ questions|length }}</strong>
</div>

<div id="quiz-container">
  {% for question in questions %}
    <div class="quiz-question" data-question-index="{{ forloop.counter0 }}" data-difficulty="{{ question.difficulty }}" data-question-id="{{ question.id }}" style="{% if not forloop.first %}display:none;{% endif %}">
        <p class="text-muted mb-2">
        <span class="badge 
          {% if question.difficulty == 'easy' %}bg-success
          {% elif question.difficulty == 'medium' %}bg-primary
          {% elif question.difficulty == 'hard' %}bg-warning text-dark
          {% elif question.difficulty == 'hardcore' %}bg-danger
          {% else %}bg-secondary
          {% endif %}">
          {{ question.difficulty|title }}
        </span>
      </p>
      <h4>Q{{ forloop.counter }}: {{ question.question_text|safe }}</h4>

      

      <div class="quiz-answers mt-3 answer-block-offset">
        {% with question_index=forloop.counter0 %}
            {% for letter in "ABCD" %}
                {% with attr_name="option_"|add:letter|lower %}
                {% with choice=question|get_attr:attr_name %}
                    <div class="form-check mb-2">
                        <input class="form-check-input answer-option"
                        type="radio"
                        name="question-{{ question_index }}"
                        value="{{ letter }}"
                        id="q{{ question_index }}-{{ letter }}"
                        {% if letter == question.correct_option %}data-correct{% endif %}>
                 
                    <label class="form-check-label" for="q{{ question_index }}-{{ letter }}">
                        {{ letter }}. {{ choice }}
                    </label>
                    </div>
                {% endwith %}
                {% endwith %}
            {% endfor %}
        {% endwith %}

        {% if question.explanation %}
            <div class="question-explanation d-none" data-explanation="{{ question.explanation }}"></div>
        {% endif %}


      </div>
    </div>
  {% endfor %}
</div>

<div class="bottom-bar d-flex justify-content-between align-items-center">
    <div id="question-timer" class="text-muted fw-semibold">
      Time left: <span id="timer-display">--:--</span>
    </div>
    <button id="next-btn" class="btn btn-primary btn-lg" disabled>Next</button>
</div>


<!-- Buffer to prevent content being hidden -->
<div class="bottom-buffer"></div>

<div id="quiz-meta" data-time-per-question="{{ time_per_question|default:1|floatformat:2 }}"></div>

<script src="{% static 'js/quiz.js' %}"></script>

{% endblock %}
